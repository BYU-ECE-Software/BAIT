generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Conversation {
  Conversation_ID Int          @id @default(autoincrement())
  User_ID         Int
  Campaign_ID     Int
  Character_ID    Int
  From_ID         Int
  Realtime        Boolean?     @default(false)
  User            User         @relation(fields: [User_ID], references: [User_ID], onUpdate: Restrict, map: "Conversation_ibfk_1")
  Message         Message[]
  Transcript      Transcript[]

  @@index([User_ID], map: "User_ID")
}

model Message {
  Message_ID      Int          @id @default(autoincrement())
  User_Sent       Boolean?     @default(false)
  Message         String       @db.Text
  Timestamp       DateTime
  Conversation_ID Int
  Conversation    Conversation @relation(fields: [Conversation_ID], references: [Conversation_ID], onUpdate: Restrict, map: "Message_ibfk_1")

  @@index([Conversation_ID], map: "Conversation_ID")
}

model Transcript {
  Transcript_ID   Int          @id @default(autoincrement())
  Text            String       @db.Text
  Timestamp       DateTime
  Conversation_ID Int
  Conversation    Conversation @relation(fields: [Conversation_ID], references: [Conversation_ID], onUpdate: Restrict, map: "Transcript_ibfk_1")

  @@index([Conversation_ID], map: "Conversation_ID")
}

model Session {
  Token      String   @id @db.VarChar(255)
  Expiration DateTime @db.Date
  User_ID    Int
  User       User     @relation(fields: [User_ID], references: [User_ID], onUpdate: Restrict, map: "Session_ibfk_1")

  @@index([User_ID], map: "User_ID")
}

model User {
  User_ID      Int            @id @default(autoincrement())
  Password     String         @db.VarChar(255)
  Name         String         @db.VarChar(100)
  Email        String         @unique(map: "Email") @db.VarChar(255)
  Conversation Conversation[]
  Session      Session[]
  UserEventLog UserEventLog[]
}

model UserEventLog {
  Event_ID   Int      @id @default(autoincrement())
  User_ID    Int
  Event_Name String   @db.VarChar(50)
  Timestamp  DateTime
  User       User     @relation(fields: [User_ID], references: [User_ID], onUpdate: Restrict, map: "UserEventLog_ibfk_1")

  @@index([User_ID], map: "User_ID")
}
