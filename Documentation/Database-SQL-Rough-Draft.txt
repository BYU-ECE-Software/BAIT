CREATE DATABASE SEPTiC_Database;

USE SEPTiC_Database;

CREATE TABLE Intel (
  Intel_ID INT NOT NULL AUTO_INCREMENT,
  Character_ID INT NOT NULL,
  Campaign_ID INT NOT NULL,
  PRIMARY KEY (Intel_ID),
  UNIQUE (Character_ID),
  UNIQUE (Campaign_ID)
);

CREATE TABLE User (
  User_ID INT NOT NULL AUTO_INCREMENT,
  Password VARCHAR(255) NOT NULL,
  Name VARCHAR(100) NOT NULL,
  Email VARCHAR(255) NOT NULL,
  PRIMARY KEY (User_ID)
);

CREATE TABLE Conversation (
  Conversation_ID INT NOT NULL AUTO_INCREMENT,
  User_ID INT NOT NULL,
  PRIMARY KEY (Conversation_ID),
  FOREIGN KEY (User_ID) REFERENCES User(User_ID)
);

CREATE TABLE Session (
  Session_ID INT NOT NULL AUTO_INCREMENT,
  Token VARCHAR(255) NOT NULL,
  Expiration DATE NOT NULL,
  User_ID INT NOT NULL,
  PRIMARY KEY (Session_ID),
  FOREIGN KEY (User_ID) REFERENCES User(User_ID)
);

CREATE TABLE knows (
  User_ID INT NOT NULL,
  Campaign_ID INT NOT NULL,
  PRIMARY KEY (User_ID, Campaign_ID),
  FOREIGN KEY (User_ID) REFERENCES User(User_ID),
  FOREIGN KEY (Campaign_ID) REFERENCES Intel(Intel_ID)
);

CREATE TABLE Message (
  Message_ID INT NOT NULL AUTO_INCREMENT,
  User_Sent BOOLEAN DEFAULT FALSE,
  Message TEXT NOT NULL,
  Timestamp DATE NOT NULL,
  Conversation_ID INT NOT NULL,
  PRIMARY KEY (Message_ID),
  FOREIGN KEY (Conversation_ID) REFERENCES Conversation(Conversation_ID)
);
